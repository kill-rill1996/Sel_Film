{% extends 'base.html' %}
{% load static %}


{% block content %}

<div class="container mx-auto">
    <div class="grid grid-cols-1 sm:grid-cols-2 justify-items-center mt-10">

        <!--Левый фильм -->
        <div class="grid w-full justify-items-center">
            {% if film_1 %}
            <div class="mb-4 sm:mb-6">
                <h2 class="text-lg text-indigo-800"><a href="{{ film_1.get_absolute_url }}" target="_blank">{{ film_1.title_ru|capfirst }}{% if film_1.year %} ({{ film_1.year }}){% endif %}</a></h2>
            </div>
            <div class="grid w-2/5 sm:w-3/5 md:w-5/12 xl:w-3/5 justify-items-center">
                <a href="{{ film_1.get_absolute_url }}" target="_blank"><img class="rounded-lg shadow-lg" src="{{ film_1.image.url }}" alt=""></a>
            </div>
            {% else %}
            <div class="mb-4 sm:mb-6">
                <h2 class="text-lg text-indigo-800">{% block title_1 %}Фильм 1{% endblock title_1 %}</h2>
            </div>
            <div class="grid w-2/5 sm:w-3/5 md:w-5/12 xl:w-3/5 justify-items-center">
                <img class="rounded-lg shadow-lg" src="{% static 'images/poster.jpeg' %}" alt="">
            </div>
            {% endif %}
        </div>

        <!--Правый фильм-->
        <div class="grid w-full justify-items-center">
            {% if film_2 %}
                <div class="mt-8 sm:mt-0 mb-4 sm:mb-6">
                    <h2 class="text-lg text-indigo-800"><a href="{{ film_2.get_absolute_url }}" target="_blank">{{ film_2.title_ru|capfirst }} {% if film_2.year %}({{ film_2.year }}){% endif %}</a></h2>
                </div>
                <div class="grid w-2/5 sm:w-3/5 md:w-5/12 xl:w-3/5 justify-items-center">
                    <a href="{{ film_2.get_absolute_url }}" target="_blank"><img class="rounded-lg shadow-lg" src="{{ film_2.image.url }}" alt=""></a>
                </div>
            {% else %}
                <div class="mt-8 sm:mt-0 mb-4 sm:mb-6">
                    <h2 class="text-lg text-indigo-800">{% block title_2 %}Фильм 2{% endblock title_2 %}</h2>
                </div>
                <div class="grid w-2/5 sm:w-3/5 md:w-5/12 xl:w-3/5 justify-items-center">
                    <img class="rounded-lg shadow-lg" src="{% static 'images/poster.jpeg' %}" alt="">
                </div>
            {% endif %}
        </div>
    </div>

    <!--    Поисковые вводы, кнопка поиска-->
    <div class="grid grid-cols-1">
        <div class="w-full justify-items-center">
               <div class="mt-6 w-full text-sm sm:text-base">
                   <form method="post"  action="{% block action_form %}{% url 'search-films' %}{% endblock action_form %}">
                        {% csrf_token %}
                        <div class="grid grid-cols-1 sm:grid-cols-2 justify-items-center">
                            <div class="w-44 mb-4 sm:mb-0 md:w-44 lg:w-56 xl:w-80">
                                {{ form_1 }}
                            </div>
                            <div class="w-44 mb-4 sm:mb-0 md:w-44 lg:w-56 xl:w-80">
                                {{ form_2 }}
                            </div>
                        </div>
                        <div class="grid grid-cols-1 justify-items-center">
                            <button type="submit" class="grid w-30 md:w-34 lg:w-40 bg-gray-100 text-gray-700 border-0 py-1 px-3 focus:outline-none hover:bg-gray-200 rounded-xl text-xs md:text-sm lg:text-base mt-4 md:mt-0"><span><i class="fas fa-search mr-2"></i>Подобрать</span></button>
                        </div>
                   </form>
               </div>
               {% if films_duplicate %}
                   <hr class="mt-8 mb-4">
                   <p>Вы ввели два одинаковых фильма.</p>
               {% else %}
                    {% if films_1_query or films_2_query %}
                        <hr class="mt-8 mb-4">
                        {% if films_1_query and not film_2 and not films_2_query %}
                            <p>Возможно вы искали (фильм № 1):</p>
                            <ul>
                              {% for film in films_1_query %}
                                <li><a target="_blank" href="{{ film.get_absolute_url }}">{{ film.title_ru|capfirst }} ({{ film.year }})</a></li>
                              {% endfor %}
                            </ul>
                            <p>Фильм № 2 не найден.</p>
                        {% endif %}

                        {% if films_1_query and film_2 %}
                            <p>Возможно вы искали (фильм № 1):</p>
                            <ul>
                              {% for film in films_1_query %}
                                <li><a target="_blank" href="{{ film.get_absolute_url }}">{{ film.title_ru|capfirst }} ({{ film.year }})</a></li>
                              {% endfor %}
                            </ul>
                        {% endif %}

                        {% if films_2_query and not film_1 and not films_1_query %}
                            <p>Фильм № 1 не найден.</p>
                            <p>Возможно вы искали (фильм № 2):</p>
                            <ul>
                              {% for film in films_2_query %}
                                <li><a target="_blank" href="{{ film.get_absolute_url }}">{{ film.title_ru|capfirst }} ({{ film.year }})</a></li>
                              {% endfor %}
                            </ul>
                        {% endif %}

                        {% if films_2_query and film_1 %}
                            <p>Возможно вы искали (фильм № 2):</p>
                            <ul>
                              {% for film in films_2_query %}
                                <li><a target="_blank" href="{{ film.get_absolute_url }}">{{ film.title_ru|capfirst }} ({{ film.year }})</a></li>
                              {% endfor %}
                            </ul>
                        {% endif %}

                        {% if films_1_query and films_2_query %}
                            <p>Возможно вы искали (фильм № 1):</p>
                            <ul>
                              {% for film in films_1_query %}
                                <li><a target="_blank" href="{{ film.get_absolute_url }}">{{ film.title_ru|capfirst }} ({{ film.year }})</a></li>
                              {% endfor %}
                            </ul>
                            <p>Возможно вы искали (фильм № 2):</p>
                            <ul>
                              {% for film in films_2_query %}
                                <li><a target="_blank" href="{{ film.get_absolute_url }}">{{ film.title_ru|capfirst }} ({{ film.year }})</a></li>
                              {% endfor %}
                            </ul>
                        {% endif %}

                    {% elif film_1 and not film_2 %}
                        <hr class="mt-8 mb-4">
                        <p>Фильм № 2 не найден.</p>

                    {% elif film_2 and not film_1 %}
                        <hr class="mt-8 mb-4">
                        <p>Фильм № 1 не найден.</p>

                    {% elif request.method == 'POST' and not film_1 and not film_2 %}
                        <hr class="mt-8 mb-4">
                        <p>Фильмы не найдены. Попробуйте найти названия фильмов через <a class="text-indigo-500" href="#">поиск</a></p>
                    {% endif %}
                {% endif %}
        </div>
    </div>


<!--Результаты поиска-->
    {% if top_ten %}
    <hr class="mt-8">
        <div class="grid grid-cols-2 sm:grid-cols-5 xl:grid-cols-10 gap-x-4 gap-y-4 sm:gap-x-10 sm:gap-y-10 mt-10 text-sm sm:text-xs md:text-sm mb-8">
                {% for film in top_ten %}
                    {% include 'includes/card_for_top_ten.html' %}
                {% endfor %}
        </div>
    {% endif %}
</div>

{% endblock content %}

























